jQuery(document).ready(function(p){var d,s,o=p(".wppizza-admin-orders"),a=p(".wppizza-admin-orders-attributes"),t=0<o.length,u=1e3*wppizza.aopt;t&&(d=function(){var e,t=o.attr("id").split("-").pop(-1),r=a.val(),i=JSON.parse(r);void 0!==i.audio_notify&&(e=new Audio(i.audio_notify)),o.prepend('<div class="wppizza-loading"></div>'),jQuery.post(wppizza.ajaxurl,{action:"wppizza_json",vars:{type:"admin-order-history",post_id:t,atts:r}},function(t){console.log("orders polling"),void 0!==t.notify&&e.play(),o.html(t.html)},"json").fail(function(t,e,r){alert("error[print] : "+r)})},s=setInterval(d,u),p(document).on("change",".wppizza-admin_orderhistory-order-status",function(t){clearInterval(s);var e=p(this),r=e.attr("id").split("-").pop(-1),o=e.val(),a=!1,n=r.split("_");jQuery.post(wppizza.ajaxurl,{action:"wppizza_json",vars:{type:"admin-change-status",uoKey:r,status:o}},function(t){return void 0!==t.update_prohibited?(alert(t.update_prohibited),void(a=!0)):(d(),void(void 0!==t.orderstatus_change_alert&&""!=t.orderstatus_change_alert&&alert(t.orderstatus_change_alert)))},"json").fail(function(t,e,r){alert("error[status] : "+r)}).done(function(){a||function(t,e,r,o,a){if(0<t.length)for(i=0;i<t.length;i++)new Function("self, blog_id, order_id, status","return "+t[i]+"(self, blog_id, order_id, status);")(e,r,o,a)}(wppizza.fnOrderStatusChange,e,n[0],n[1],o),s=setInterval(d,u)})}),p(document).on("click",".wppizza-order-print, .wppizza-order-view",function(t){var e=p(this),r=e.attr("id").split("-").pop(-1),i=!!e.hasClass("wppizza-order-print");jQuery.post(wppizza.ajaxurl,{action:"wppizza_json",vars:{type:"admin-view-order",uoKey:r}},function(t){var e,r=window.open("","WppizzaOrder","width="+t["window-width"]+",height="+t["window-height"]);null!=r&&void 0!==r?(r.document.open("text/html","replace"),"text/plain"==t["content-type"]?(e=t.markup.plaintext,r.document.write("<pre>"+e+"</pre>")):(e=t.markup.html,r.document.write(e)),r.focus(),i&&r.print()):alert("You must turn off your pop-up blocker to enable printing.\n\nPlease consult your device manufacturer about how to turn off pop-up blocking for this site.\n\n")},"json").fail(function(t,e,r){alert("error[view/print] : "+r)})}),p(document).on("click",".wppizza-order-delete",function(t){var e=p(this);if(!confirm(e.attr("title")+"?"))return!1;var r=e.attr("id").split("-").pop(-1);jQuery.post(wppizza.ajaxurl,{action:"wppizza_json",vars:{type:"admin-delete-order",uoKey:r}},function(t){void 0===t.update_prohibited?void 0!==t.success&&(e.closest("tr").empty().remove(),alert(t.success)):alert(t.update_prohibited)},"json").fail(function(t,e,r){alert("error[delete order] : "+r)})}))});